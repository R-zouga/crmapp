{% extends 'customcomponents/dashboard.html' %}
{% load custom_filter %}
{% load static %}

{% block styles3 %}
    <link rel="stylesheet" href="{% static 'customcss/table.css' %}">
{% endblock styles3 %}

{% block navigation %}
    <a href="{% url 'lost-deals' %}">Your lost deals</a>
    <a href="{% url 'appended-deals' %}">Your appended deals</a>
    <a href="{% url 'waits-meeting' %}">Set Meeting</a>
{% endblock navigation %}
{% block dashboard %}
    <h2 class="table">Your following meetings</h2>
    <ul>
        {% for upcoming_meeting in upcoming_meetings %}
            <li>You have a meeting with {{ upcoming_meeting.deal_id.service_seeker.full_name }}
                at <b>{{ upcoming_meeting.scheduled_time|custom_date }}</b></li>
        {% endfor %}
    </ul>

    <h2 class="plot">Your earnings for This Year</h2>
    <div id="earnings-histogram" style="width: 100%; height: 400px;"></div>

{% endblock dashboard %}
{% block scripts2 %}
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script>
        const months = {{ months|safe }};
        const earnings = {{ earnings|safe }};


        const trace = {
            x: months,
            y: earnings,
            type: 'bar',
            marker: {
                color: 'rgb(0, 123, 255)',
            }
        };

        const data = [trace];

        const layout = {
            title: 'Earnings by Month',
            xaxis: {
                title: 'Month',
                tickmode: 'array',
                tickvals: months,  // Display each month
            },
            yaxis: {
                title: 'Total Earnings',
            },
            paper_bgcolor: '#fefcfb',
            plot_bgcolor: '#fefcfb'
        };

        Plotly.newPlot('earnings-histogram', data, layout, { displayModeBar: false });
    </script>
{% endblock scripts2 %}

CREATE DATABASE CRMProject;
GRANT ALL PRIVILEGES ON DATABASE CRMProject TO zouga;

